#django 

# Formularze
#django/formularze 

- `forms` formularz - pozwala dodawać i edytować elementy dynamiczne

## budowanie formularzy:
	- od zera lub
	- formularz modelu (`ModelForm`), który zapusze dane wynikowe w danym modelu
- mają swój własny plik :`forms.py`
- należy utworzyć plik o takiej nazwie w katalogu bieżącym aplikacji np. `<nazwa_aplikacji> - forms.py`

## Rola formularzy
trzy części pracy formularzy:
- przygotowanie danych gotowych do odtwarzania, konwersję danych
- tworzenie formularzy HTML dla danych,
- odbieranie i przetwarzanie wysłanych danych przez klienta, ich walidację po  stronie aplikacji
- 

## Klasa `Form` i `ModelForm`
#django/form #django/ModelForm
to klasy, które umożliwiają tworzenie formularzy

Podstawą systemu komponentów jest klasa `Form`.
- są one tworzone jako klasy pochodne `django.forms.Form` 
- opisuje formularz

Klasa `ModelForm` odwzorowuje pola modelu do elementów:
- pola formularzy są reprezentowane przez klasy, które zarządzają  danymi formularzy sprawdzają ich poprawność, gdy formularz jest wysyłany
- opisują logiczną strukturę obiektów, ich zacowania

**pola formularzy** są prezentowane użytwonikowi w przeglądarce jako widgety HTML (typ pola <--> klasa widgetu)

## Tworzenie formularzy
```python
from django import forms
class NameForm(forms.Form):
your_name = forms.CharField(label="Your name" , max_length=100)
```


aby otrzymać kod HTML utwórz obiekt:
```python
f = NameForm()

```


## Praca z formularzami w widokach
```python
def view(request):
 if request.method == 'POST':
  form = Form(request.POST) # tworzony jest formularz
 if form.is_valid():
	  return HttpResponseRedirect('/tanks')
 elif request.method == 'GET':
  form = NameForm()
 else:
  return (HttpResponse(status=403))

 return render(request, 'name.html', {'form': form})
```

## Umieszczanie formularzy w szablonie
formularz potrafi wyświetlić pola i ewentualne błędy walidacji
nie wyświetla samego tagu `<form>` oraz przycisku `submit`

```html
<form action="/your-name" method="post">
 {% csrd_token %}
 {{ form }}
 <input type="submit" value="Submit" />
</form>
```


## utworzenie formularza na podstawie modelu
- należy wskazać model w klasie Meta formularza
- Django przeanalizuje podany model i następnie dynamicznie utworzy formularz
- każdy typ kolumny modelu będzie miał odpowiadający mu domyślny **typ pola** w formularzu

p r z y k ł a d
```python
from django import forms
from .models import Post

class PostForm(forms.ModelForm):
	class Meta:
		model = Post
		fields = ('title', 'text', )
```

`class Meta` - Django będzie wiedział, że `model Post` powinien być wykorzystywany do stworzenia tego formularza, wskazujemy pola, które mają pojawić się w formularzu: `title`, `text`, 
teraz można już użyć formularza wewnątrz *widoku* i wyświetlić go w *szablonie*

`blog/view.py`
```python
from .forms import PostForm

def post_new(request):
	form = PostForm()
	return render(request, 'blog/post_edit.html', {'form': form})
```

`blog/templates/blog/post_edit.html`
```html
{% extends 'blog/base.html' %}

{% block content %}
 <h2> New post </h2>
 <form method="POST" class="post-form">
   {% csrf_token  %}
   {{ form.as_p}}
   <button type="submit" class="save btn btn-default"> Save </button>
   </form>
{% endblock %}
```

kroki do przejścia, aby formularz zadziałał
**Szablon** musi zawierać niezbędne kroki:
- wyświetlać formularz np. za pomocą polecenia `{{form.as_p}}` - polecenie to musi znajdować się wewnątrz znacznika formularza HTML
- `<form method='POST'>...</form>`
- zawierać przycisk Zapisz, utworzony np. jako przycisk w HTML:
	- `<button type="submit"> Save </button>`
- po znaczniku otwierającym `<form ...>` należy dodać `{% csrf_token %}` dzięki czemu formularz będzie bezpieczny

**Widok** musi przetwarzać dwie możliwe sytuacje:
- gdy wchodzimy na stronę po raz pierwszy i chcemy pusty formularz
- gdy ponownie znajdziemy się w widoku wraz ze wszystkimi danymi wpisanymi przez nas w formularzu










